SELECT SUM(SAL) FROM EMP;
-- sum값은 하나밖에 나오지 않는 데이터이다.
-- 직원명의 경우 결과가 여러개 나온다.
-- 다중행 함수에서 ENAME과 함께쓰는 형태는 같이 사용 불가능하다. 

--중복이 있어도 합쳐짐 ALL은 기본값 생략 가능
SELECT SUM(ALL SAL) FROM EMP;

-- ALL은 기본값 생략 가능
SELECT SUM(SAL), SUM(DISTINCT SAL) FROM EMP;


SELECT * FROM EMP;
SELECT COUNT(JOB), COUNT(DISTINCT JOB) FROM EMP;
-- COUNT(ALL JOB): 14 / COUNT(DISTINCT JOB): 5

SELECT COUNT(JOB), COUNT(DISTINCT JOB), COUNT(COMM), COUNT(*)
FROM EMP;


SELECT MAX(HIREDATE), MIN(HIREDATE) FROM EMP;

-- 평균
SELECT AVG(SAL), AVG(DISTINCT SAL) FROM EMP;



SELECT AVG(SAL) 평균급여 FROM EMP; --전체 급여 1개

-- DEPTNO(부서)의 공통적인 값으로 그룹화
--이렇게만 출력하면 어떤 부서인지 알 수 없음
SELECT ROUND(AVG(SAL)) 
	평균급여 FROM EMP GROUP BY DEPTNO;  --3개의 레코드 출력

-- 통계 개수와 레코드의 개수가 동일하기 때문에 SELECT문에 작성 가능
SELECT DEPTNO, ROUND(AVG(SAL)) 
	평균급여 FROM EMP GROUP BY DEPTNO;	

SELECT DEPTNO,JOB, ROUND(AVG(SAL))
FROM EMP 
--WHERE AVG(SAL) <= 1000 --WHERE절에 집계함수의 결과값은 사용할 수 없다.
GROUP BY DEPTNO, JOB;  --9개의 레코드 출력
-- 부서번호와 직책으로 그룹화

SELECT DEPTNO,JOB, ROUND(AVG(SAL))
FROM EMP 
GROUP BY DEPTNO, JOB
HAVING AVG(SAL) <= 1000 AND AVG(SAL) <= 3000;


SELECT DEPTNO, JOB, 
	SUM(SAL) 합계,
	ROUND(AVG(SAL)) 평균,
	MAX(SAL) 최대급여,
	MIN(SAL) 최소급여,
	COUNT(*) 직원수
FROM EMP GROUP BY CUBE(DEPTNO, JOB) ORDER BY DEPTNO, JOB;






