--- Q1 **
SELECT DEPTNO, TRUNC(AVG(SAL)) AS AVG_SAL, 
--ROUND: 반올림 0일때 소수 첫째자리에서 반올림
--TRUNC: 절사
MAX(SAL) AS MAX_SAL,
MIN(SAL) AS MIN_SAL,
COUNT(*) AS CNT
FROM EMP GROUP BY DEPTNO ;


-- Q2
SELECT JOB, COUNT(*) 
FROM EMP GROUP BY JOB
HAVING COUNT(*) >= 3;

--Q3 **********
SELECT TO_CHAR(HIREDATE,'YYYY') AS HIRE_YEAR,
	DEPTNO,	COUNT(*) AS CNT 
FROM EMP GROUP BY TO_CHAR(HIREDATE,'YYYY'), DEPTNO ; 


--Q4
SELECT NVL2(COMM,'O','X') EXIST_COMM,
COUNT(*) CNT 
FROM EMP GROUP BY NVL2(COMM,'O','X');

-- Q5
SELECT DEPTNO,
	TO_CHAR(HIREDATE,'YYYY') HIRE_YEAR,
	COUNT(*) CNT,
	MAX(SAL) MAX_SAL,
	SUM(SAL) SUM_SAL,
	AVG(SAL) AVG_SAL
FROM EMP 
GROUP BY ROLLUP(DEPTNO,TO_CHAR(HIREDATE,'YYYY')) ORDER BY DEPTNO;
--ROLL UP: 요약정보, 총 결과 출력