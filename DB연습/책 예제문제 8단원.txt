-- Q1
SELECT D.DEPTNO, D.DNAME, E.EMPNO, E.ENAME, E.SAL 
FROM EMP E, DEPT D 
WHERE E.DEPTNO = D.DEPTNO
AND E.SAL > 2000;


<SQL 99 방식>


--Q2
SELECT D.DEPTNO, D.DNAME,
FLOOR(AVG(SAL)) AVG_SAL, --자리 버림 TRUNC(AVG(SAL)) AS AVG_SAL
MAX(SAL) MAX_SAL,
MIN(SAL) MIN_SAL,
COUNT(*) CNT
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
GROUP BY D.DEPTNO, D.DNAME;

<SQL 99 방식>


-- Q3  ****
SELECT D.DEPTNO, D.DNAME,
E.EMPNO, E.ENAME, E.JOB, E.SAL
FROM EMP E, DEPT D
WHERE E.DEPTNO(+) = D.DEPTNO
ORDER BY D.DEPTNO, E.ENAME;

<SQL 99 방식>

--Q4
SELECT D.DEPTNO, D.DNAME,
E.EMPNO, E.ENAME,E.MGR,E.SAL,
E.DEPTNO AS DEPTNO_1,
S.LOSAL,S.HISAL,S.GRADE,
E2.EMPNO AS MGR_EMPNO,
E2.ENAME AS MGR_ENAME
FROM EMP E, DEPT D, SALGRADE S,EMP E2
WHERE D.DEPTNO = E.DEPTNO(+);

WHERE E.DEPTNO(+) = D.DEPTNO
   AND E.SAL BETWEEN S.LOSAL(+) AND S.HISAL(+)
   AND E.MGR = E2.EMPNO(+)
ORDER BY D.DEPTNO, E.EMPNO; 