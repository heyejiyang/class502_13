SELECT * FROM DEPT;

SELECT * FROM EMP 
WHERE SAL < (SELECT MIN(SAL) FROM EMP WHERE DEPTNO =30);--서브쿼리

SELECT EMPNO, ENAME, 
	(SELECT DNAME FROM DEPT D WHERE D.DEPTNO = E.DEPTNO)DNAME 
	--명확히 하나만 나와야함 
FROM EMP E;


SELECT MAX(SAL) FROM EMP GROUP BY DEPTNO; 

-- 부서별 최대 급여 직원 목록
SELECT * FROM EMP 
WHERE SAL IN (SELECT MAX(SAL) FROM EMP GROUP BY DEPTNO);

-- 부서별 최대 급여가 아닌 직원 목록
SELECT * FROM EMP 
WHERE SAL NOT IN (SELECT MAX(SAL) FROM EMP GROUP BY DEPTNO);

-- 부서별 최대 급여 직원 목록
SELECT * FROM EMP
WHERE SAL = ANY(SELECT MAX(SAL) FROM EMP GROUP BY DEPTNO);
-- SELECT MAX(SAL) FROM EMP GROUP BY DEPTNO 여기서 나온 결과중 어떤값 중 하나라도 SAL과 같으면 참


--30번 부서의 최대 급여보다 적게 받는 직원 목록
-- 집계함수로 사용할 경우 단일행 서브쿼리로 작성하게 된다.
SELECT * FROM EMP 
WHERE SAL < (SELECT MAX(SAL) FROM EMP WHERE DEPTNO =30); -- 단일행 서브쿼리
--SELECT MAX(SAL) FROM EMP WHERE DEPTNO =30 결과 -> 2850

SELECT * FROM EMP 
WHERE SAL < ANY(SELECT SAL FROM EMP WHERE DEPTNO =30); -- 다중행 서브쿼리 ANY연산자
-- 30번 부서의 SAL에서 가장 큰 급여는 2850임 이거보다 작으면 다 참이 되는 것


--30번 부서의 최소 급여보다 더 많이 받는 직원 목록
SELECT * FROM EMP 
WHERE SAL > (SELECT MIN(SAL) FROM EMP WHERE DEPTNO =30); -- 단일행 서브쿼리
-- SELECT MIN(SAL) FROM EMP WHERE DEPTNO =30 결과 -> 950

SELECT * FROM EMP 
WHERE SAL > ANY(SELECT SAL FROM EMP WHERE DEPTNO =30); -- 다중행 서브쿼리 ANY연산자
-- SELECT SAL FROM EMP WHERE DEPTNO =30 에서 가장 작은 급여 -> 950 이거보다 크면 다 참


-- 30번 부서의 최대 급여보다 많이 받는 직원 목록
SELECT * FROM EMP
WHERE SAL > (SELECT MAX(SAL) FROM EMP WHERE DEPTNO = 30); -- 단일행
-- SELECT MAX(SAL) FROM EMP WHERE DEPTNO = 30 결과 -> 2850

SELECT * FROM EMP
WHERE SAL > ALL(SELECT SAL FROM EMP WHERE DEPTNO=30); -- 다중행


SELECT * FROM EMP
WHERE EXISTS (SELECT * FROM DEPT WHERE DEPTNO = 30);





