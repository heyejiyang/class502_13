CREATE TABLE EMP_TRG AS SELECT * FROM EMP;

CREATE OR REPLACE TRIGGER TRG_EMP_NODML
BEFORE 
INSERT OR UPDATE OR DELETE ON EMP_TRG
BEGIN 
	IF TO_CHAR(SYSDATE, 'DY') IN ('화', '수') THEN
		IF INSERTING THEN 
			raise_application_error(-20000, '추가 불가');
		ELSIF UPDATING THEN
			raise_application_error(-20000, '수정 불가');
		ELSIF DELETING THEN 
			raise_application_error(-20000, '삭제 불가');
		ELSE 
			raise_application_error(-20000, '작업 불가');
		END IF;
	END IF;
END; 

SELECT * FROM USER_TRIGGERS;
----
CREATE TABLE EMP_TRG_LOG (
	DML_TYPE VARCHAR2(20),
	EMPNO NUMBER(4),
	ENAME VARCHAR2(20),
	REGDT DATE DEFAULT SYSDATE
); 
----
CREATE OR REPLACE TRIGGER TRG_EMP_LOG
AFTER 
INSERT OR UPDATE OR DELETE ON EMP_TRG
FOR EACH ROW 
BEGIN 
	IF INSERTING THEN 
		INSERT INTO EMP_TRG_LOG (DML_TYPE, EMPNO, ENAME)
			VALUES ('INSERT', :NEW.EMPNO, :NEW.ENAME);
	ELSIF UPDATING THEN 
		INSERT INTO EMP_TRG_LOG (DML_TYPE, EMPNO, ENAME)
			VALUES ('UPDATE', OLD.EMPNO, OLD.ENAME);
	ELSIF DELETING THEN 
		INSERT INTO EMP_TRG_LOG (DML_TYPE, EMPNO, ENAME)
			VALUES ('DELETING', OLD.EMPNO, OLD.ENAME);
	END IF;
END; 